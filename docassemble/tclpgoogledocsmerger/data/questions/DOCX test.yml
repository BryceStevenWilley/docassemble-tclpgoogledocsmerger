metadata:
  title: Default playground interview
  short title: Testing Drive
  comment: This is a learning tool
---
objects:
  - client: Individual
---
modules:
  - .drive_connection
  - .merge_docs
---
objects: 
  - template_file: DAFile
  - output_docx: DAFile
---
code: |
  #full_da_folder_id = "10ZnFEB3KQcSjqA5UTPwlEhBXjsX676XG"
  full_clauses_folder_id = "1cUi-6bjgmtiN8zf3XA0UlwsPEXU2cHXE" 
  #"1YDT_u4AJMzwJKNcAH2naYHhycNd-iHvt"
  #try:
  #  top_level = get_files_in_folder("Docassemble Folders")
  #  # template_file = download_drive_docx_file("10e2XWe2mIS-a-8IcntSu9taqFS6S_hag", "template_file.docx")
  #except Exception as ex:
  #  top_level = []
  #  log(f'top level ex: {ex}')
  #try: 
  #  clauses = get_files_in_folder("Clauses")
  #except Exception as ex:
  #  clauses = []
  #  log(f'Just "Clauses" ex: {ex}')
  from operator import itemgetter
  clauses2 = get_files_in_folder(folder_id=full_clauses_folder_id)
  clauses2.sort(key=itemgetter('name'))
  a_clause = clauses2[0]
  my_obj = DAObject(modified_time=a_clause.get('modifiedTime'), file_id=a_clause.get('id'))
  my_rtf = download_drive_docx_wrapper([my_obj], 'doc_', export_as='rtf')[0]
  output_docx.initialize(filename='output_docx.docx')
  worked = rtf_as_docx(my_rtf.path(), output_docx.path())
---
mandatory: True
question: |
  Show doc
subquestion: |

  ${ my_rtf }

  ${ worked } 
  
  ${ output_docx }

  ### Clauses 2
  % for cl in clauses2:
  * ${ cl }
      * ${ format_datetime(cl.get('modifiedTime', '')) }
  % endfor
continue button field: testing